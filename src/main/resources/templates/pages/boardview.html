<!DOCTYPE html>
<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" xmlns:th="http://www.w3.org/1999/xhtml"
      layout:decorate="~{layout}">
<head>
    <script src="https://code.jquery.com/jquery-1.12.0.min.js"></script>

    <script src="js/vendor/modernizr-3.8.0.min.js"></script>
    <script src="https://code.jquery.com/jquery-1.12.0.min.js"></script>
    <script>window.jQuery || document.write('<script src="@{/js/vendor/jquery-3.4.1.min.js}"><\/script>')</script>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
    <meta charset="UTF-8">

</head>
<body>
<section layout:fragment="content">
    <div class="row">
        <div class="col-lg-12 grid-margin">
            <div class="card">
                <div class="card-body">
                    <div class="container" style="max-width: 1000px">
                        <tr th:each="boardview, iter : ${boardview}">
                            <td>글 번호: <p th:text="${boardview.id}"></p></td>
                            <td>
                                <div id="title">
                                    제목 : <p th:text="${boardview.title}"></p>
                                </div>
                            </td>
                            <td>작성자 : <p th:text="${boardview.name}"></p></td>
                            <td>
                                내용:
                                <div id="content">
                                <textarea readonly="readonly"
                                          class="form-control"
                                          th:text="${boardview.content}">

                                </textarea>
                                </div>
                            </td>
                            <td>조회 수 : <span th:text="${boardview.read}"></span></td>
                        </tr>
                        <button id="deleteBtn" class="btn btn-danger btn-sm float-right">삭제</button>
                        <button id="updateBtn" class="btn btn-info btn-sm float-right">수정</button>

                        <form id="form" th:action="@{/}" method="post">

                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script th:inline = "javascript">


        $(document).on('ready', function(e) {
            var form=$("#form");
            /*<![CDATA[*/
            var id = /*[[${boardview.id}]]*/;
            /*]]>*/
            $(document).on('click', '#deleteBtn', function(e){
                $('#form').attr("action", "boarddelete");
                form.append("<input type='hidden' name='id' value='"+id+"'>");
                form.append("<input type='hidden' name='_method' value='delete'>");
                form.submit();
            })

            $(document).on('click', '#updateBtn', function(e){
                var str="<input class='form-control' width='250'" +
                    "placeholder='제목 입력' id='updateTitle'>";
                $("#title").html(str);
                str="<textarea class='form-control' placeholder='내용 입력'" +
                    "id='updateContent'></textarea>";
                $("#content").html(str);
                $("#updateBtn").attr("id", "updateConfirmBtn");

            })

            $(document).on('click', '#updateConfirmBtn', function(e){
                $('#form').attr("action", "boardupdate");
                var updateTitle= $('#updateTitle').val();
                var updateContent=$('#updateContent').val();
                form.append("<input type='hidden' name='id' value='"+id+"'>");
                form.append("<input type='hidden' name='_method' value='put'>");
                form.append("<input type='hidden' name='title' value='"+updateTitle+"'>");
                form.append("<input type='hidden' name='content' value='"+updateContent+"'>");
                form.submit();
            })
        })
    </script>
</section>
</body>
</html>